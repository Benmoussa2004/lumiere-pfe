<ion-header class="ion-no-border">
    <div class="glass-header">
        <ion-toolbar class="premium-toolbar">
            <ion-buttons slot="start">
                <ion-back-button defaultHref="/home" icon="arrow-back-outline"></ion-back-button>
            </ion-buttons>
            <ion-title>Mes Clients</ion-title>
            <ion-buttons slot="end">
                <ion-button (click)="createClient()">
                    <ion-icon slot="icon-only" name="person-add-outline"></ion-icon>
                </ion-button>
            </ion-buttons>
        </ion-toolbar>
        <ion-toolbar class="search-toolbar">
            <div class="search-container">
                <ion-icon name="search-outline"></ion-icon>
                <ion-input [(ngModel)]="searchTerm" (ionInput)="onSearchChange($event)"
                    placeholder="Rechercher par nom, code..."></ion-input>
            </div>
        </ion-toolbar>
    </div>
</ion-header>

<ion-content [fullscreen]="true" class="premium-content">
    <div class="glass-background">
        <div class="bubble"></div>
        <div class="bubble"></div>
    </div>

    <ion-refresher slot="fixed" (ionRefresh)="loadClients($event)">
        <ion-refresher-content></ion-refresher-content>
    </ion-refresher>

    <div class="list-container">
        <div *ngIf="isLoading" class="ion-text-center ion-padding">
            <ion-spinner color="primary"></ion-spinner>
            <p class="text-muted mt-2">Récupération de vos clients...</p>
        </div>

        <div *ngIf="!isLoading && filteredClients.length === 0" class="empty-state glass-card shadow-lg">
            <div class="empty-icon-circle">
                <ion-icon name="people-outline"></ion-icon>
            </div>
            <h3>Aucun client trouvé</h3>
            <p>Commencez par ajouter votre premier client.</p>
            <ion-button fill="clear" (click)="createClient()" class="premium-link">
                Ajouter un client
            </ion-button>
        </div>

        <div class="client-list" *ngIf="!isLoading">
            <ion-list lines="none" class="transparent-list">
                <ion-item-sliding *ngFor="let client of filteredClients" class="premium-sliding-item">
                    <ion-item class="transparent-item" (click)="editClient(client)">
                        <div class="premium-card glass-card shadow-lg client-card">
                            <div class="card-edge-accent"></div>
                            <div class="card-inner">
                                <div class="avatar-box">
                                    {{ (client.nom || 'C').charAt(0).toUpperCase() }}
                                </div>
                                <div class="client-details">
                                    <h2 class="client-name">{{ client.nom }}</h2>
                                    <div class="client-meta">
                                        <div class="id-tag">#{{ client.code }}</div>
                                        <div class="city-info">
                                            <ion-icon name="location-outline"></ion-icon>
                                            {{ client.ville || 'Ville non spécifiée' }}
                                        </div>
                                    </div>
                                </div>
                                <ion-icon name="chevron-forward-outline" class="detail-icon"></ion-icon>
                            </div>
                        </div>
                    </ion-item>

                    <ion-item-options side="end">
                        <ion-item-option (click)="editClient(client)" class="option-btn edit">
                            <ion-icon slot="icon-only" name="create-outline"></ion-icon>
                        </ion-item-option>
                        <ion-item-option (click)="deleteClient(client)" class="option-btn delete">
                            <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
                        </ion-item-option>
                    </ion-item-options>
                </ion-item-sliding>
            </ion-list>
        </div>
    </div>

    <ion-fab vertical="bottom" horizontal="end" slot="fixed">
        <ion-fab-button class="premium-fab shadow-primary" (click)="createClient()">
            <ion-icon name="add-outline"></ion-icon>
        </ion-fab-button>
    </ion-fab>
</ion-content>