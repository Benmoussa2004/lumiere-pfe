<div class="chatbot-container">
    <!-- Bouton flottant du chatbot -->
    <div class="chatbot-button" (click)="toggleChat()" [class.active]="isChatOpen">
        <i class="fas" [ngClass]="isChatOpen ? 'fa-times' : 'fa-comments'"></i>
        <span class="notification-badge" *ngIf="!isChatOpen && hasNewMessages">{{unreadCount}}</span>
    </div>

    <!-- Fenêtre de chat -->
    <div class="chat-window" [class.open]="isChatOpen">
        <!-- En-tête du chat -->
        <div class="chat-header">
            <div class="header-content">
                <div class="bot-avatar">
                    <i class="fas fa-robot"></i>
                </div>
                <div class="header-info">
                    <h3>Assistant Lumière</h3>
                    <p class="status">
                        <span class="status-dot"></span>
                        En ligne
                    </p>
                </div>
            </div>
            <button class="close-btn" (click)="toggleChat()">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <!-- Zone de messages -->
        <div class="chat-messages" #messagesContainer>
            <div class="message-wrapper" *ngFor="let message of messages" [class.user-message]="message.isUser"
                [class.bot-message]="!message.isUser">
                <div class="message">
                    <div class="message-avatar" *ngIf="!message.isUser">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="message-content">
                        <p>{{message.text}}</p>
                        <span class="message-time">{{message.time}}</span>
                    </div>
                </div>
            </div>

            <!-- Indicateur de frappe -->
            <div class="typing-indicator" *ngIf="isTyping">
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
                <div class="typing-dot"></div>
            </div>
        </div>

        <!-- Suggestions rapides -->
        <div class="quick-replies" *ngIf="showQuickReplies">
            <button class="quick-reply-btn" *ngFor="let reply of quickReplies" (click)="sendQuickReply(reply)">
                {{reply}}
            </button>
        </div>

        <!-- Zone de saisie -->
        <div class="chat-input">
            <input type="text" [(ngModel)]="userInput" (keyup.enter)="sendMessage()"
                placeholder="Tapez votre message..." [disabled]="isTyping">
            <button class="send-btn" (click)="sendMessage()" [disabled]="!userInput.trim() || isTyping">
                <i class="fas fa-paper-plane"></i>
            </button>
        </div>
    </div>
</div>
